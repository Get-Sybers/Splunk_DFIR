

[zeek]
TRANSFORMS-autotype    = zeek_autotype,TrashComments
FIELD_DELIMITER        = tab
FIELD_HEADER_REGEX     = ^#fields\t(.*)
HEADER_FIELD_DELIMITER = tab
INDEXED_EXTRACTIONS    = tsv
KV_MODE                = none
LINE_BREAKER           = ([\r\n]+)
PREAMBLE_REGEX         = ^#
SHOULD_LINEMERGE       = false
TIMESTAMP_FIELDS       = ts
TIME_FORMAT            = %Y-%m-%dT%H:%M:%S%z
TRUNCATE               = 0

[zeek:conn]
LOOKUP-conn_history   = zeek_conn_history history_letter OUTPUTNEW history_meaning tcp_flag tcp_session_source
LOOKUP-conn_state     = zeek_conn_state conn_state OUTPUTNEW action, conn_state_meaning AS connection_state_description
FIELDALIAS-id_orig_h  = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p  = id_orig_p AS src_port
FIELDALIAS-id_resp_h  = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p  = id_resp_p AS dest_port
FIELDALIAS-proto      = proto ASNEW transport
FIELDALIAS-src_mac    = mac AS src_mac
FIELDALIAS-ts         = ts AS timestamp
FIELDALIAS-uid        = uid AS flow_id
FIELDALIAS-service    = service ASNEW app
FIELDALIAS-orig_bytes = orig_bytes ASNEW bytes_out
FIELDALIAS-resp_bytes = resp_bytes ASNEW bytes_in
FIELDALIAS-orig_pkts  = orig_pkts ASNEW packets_out
FIELDALIAS-resp_pkts  = resp_pkts ASNEW packets_in
EVAL-product          = "Zeek"
EVAL-sensor_name      = coalesce(system_name, host, "unknown")
EVAL-vendor_product   = "Zeek"
EVAL-bytes            = tonumber(bytes_out) + tonumber(bytes_in)
EVAL-packets          = tonumber(packets_out) + tonumber(packets_in)
EVAL-history_letter   = split(history,"")
# EXTRACT -> REPORT -> KV_MODE -> FIELDALIAS -> EVAL -> LOOKUP -> EVENTTYPES -> TAGS

[zeek:dns]
FIELDALIAS-id_orig_h  = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p  = id_orig_p AS src_port
FIELDALIAS-id_resp_h  = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p  = id_resp_p AS dest_port
FIELDALIAS-proto      = proto ASNEW transport
FIELDALIAS-src_mac    = mac AS src_mac
FIELDALIAS-ts         = ts AS timestamp
FIELDALIAS-uid        = uid AS flow_id
FIELDALIAS-qtype      = qtype ASNEW query_type_id
FIELDALIAS-rcode      = rcode ASNEW reply_code_id
FIELDALIAS-qtype_name = qtype_name ASNEW record_type
FIELDALIAS-rcode_name = rcode_name ASNEW reply_code
FIELDALIAS-trans_id   = trans_id ASNEW transaction_id
FIELDALIAS-rtt        = rtt ASNEW duration
FIELDALIAS-answer     = answers ASNEW answer
EVAL-product          = "Zeek"
EVAL-sensor_name      = coalesce(system_name, host, "unknown")
EVAL-vendor_product   = "Zeek"

[zeek:http]
FIELDALIAS-id_orig_h         = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p         = id_orig_p AS src_port
FIELDALIAS-id_resp_h         = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p         = id_resp_p AS dest_port
FIELDALIAS-proto             = proto ASNEW transport
FIELDALIAS-src_mac           = mac AS src_mac
FIELDALIAS-ts                = ts AS timestamp
FIELDALIAS-uid               = uid AS flow_id
FIELDALIAS-status_code       = status_code ASNEW status
FIELDALIAS-referrer          = referrer ASNEW http_referrer
FIELDALIAS-user_agent        = user_agent ASNEW http_user_agent
FIELDALIAS-username          = username ASNEW user
FIELDALIAS-uri               = uri ASNEW uri_path
FIELDALIAS-method            = method ASNEW http_method
FIELDALIAS-request_body_len  = request_body_len ASNEW bytes_out
FIELDALIAS-response_body_len = response_body_len ASNEW bytes_in
FIELDALIAS-resp_fuids        = resp_fuids ASNEW file_id
EVAL-product                 = "Zeek"
EVAL-sensor_name             = coalesce(system_name, host, "unknown")
EVAL-vendor_product          = "Zeek"
EVAL-http_user_agent_length  = len(http_user_agent)
EVAL-bytes                   = bytes_in + bytes_out
EVAL-url                     = extracted_host . uri
EVAL-url_length              = len(extracted_host . uri)
EVAL-uri_query               = mvjoin(mvindex(split(uri,"?"),1, -1), "?")

[zeek:ocsp]
FIELDALIAS-id_orig_h    = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p    = id_orig_p AS src_port
FIELDALIAS-id_resp_h    = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p    = id_resp_p AS dest_port
FIELDALIAS-proto        = proto ASNEW transport
FIELDALIAS-src_mac      = mac AS src_mac
FIELDALIAS-ts           = ts AS timestamp
FIELDALIAS-uid          = uid AS flow_id
FIELDALIAS-serialNumber = serialNumber ASNEW ssl_serial
EVAL-product            = "Zeek"
EVAL-sensor_name        = coalesce(system_name, host, "unknown")
EVAL-vendor_product     = "Zeek"

[zeek:files]
FIELDALIAS-id_orig_h      = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p      = id_orig_p AS src_port
FIELDALIAS-id_resp_h      = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p      = id_resp_p AS dest_port
FIELDALIAS-proto          = proto ASNEW transport
FIELDALIAS-src_mac        = mac AS src_mac
FIELDALIAS-ts             = ts AS timestamp
FIELDALIAS-uid            = uid AS flow_id
FIELDALIAS-fuid           = fuid ASNEW file_id
FIELDALIAS-name           = filename ASNEW file_name
FIELDALIAS-path           = path ASNEW file_path
FIELDALIAS-size           = seen_bytes ASNEW file_size
FIELDALIAS-times_accessed = times_accessed ASNEW file_access_time
FIELDALIAS-times_modified = times_modified ASNEW file_modify_time
FIELDALIAS-times_created  = times_created ASNEW file_create_time
EVAL-product              = "Zeek"
EVAL-sensor_name          = coalesce(system_name, host, "unknown")
EVAL-vendor_product       = "Zeek"
EVAL-file_hash            = case(sha256!="-", sha256, sha1!="-",sha1,md5!="-",md5,true(),"-")

[zeek:ftp]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:ssl]
LOOKUP-ssl_history      = zeek_ssl_history ssl_history_letter OUTPUTNEW history_meaning ssl_source
FIELDALIAS-id_orig_h    = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p    = id_orig_p AS src_port
FIELDALIAS-id_resp_h    = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p    = id_resp_p AS dest_port
FIELDALIAS-proto        = proto ASNEW transport
FIELDALIAS-src_mac      = mac AS src_mac
FIELDALIAS-ts           = ts AS timestamp
FIELDALIAS-uid          = uid AS flow_id
FIELDALIAS-ssl_version  = version ASNEW ssl_version
EVAL-product            = "Zeek"
EVAL-sensor_name        = coalesce(system_name, host, "unknown")
EVAL-vendor_product     = "Zeek"
EVAL-ssl_history_letter = split(ssl_history,"")

[zeek:x509]
FIELDALIAS-id_orig_h                    = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p                    = id_orig_p AS src_port
FIELDALIAS-id_resp_h                    = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p                    = id_resp_p AS dest_port
FIELDALIAS-proto                        = proto ASNEW transport
FIELDALIAS-src_mac                      = mac AS src_mac
FIELDALIAS-ts                           = ts AS timestamp
FIELDALIAS-uid                          = uid AS flow_id
FIELDALIAS-certificate_version          = certificate_version ASNEW ssl_version
FIELDALIAS-certificate_serial           = certificate_serial ASNEW ssl_serial
FIELDALIAS-certificate_not_valid_before = certificate_not_valid_before ASNEW ssl_start_time
FIELDALIAS-certificate_not_valid_after  = certificate_not_valid_after ASNEW ssl_end_time
FIELDALIAS-certificate_issuer           = certificate_issuer ASNEW ssl_issuer
FIELDALIAS-certificate_key_alg          = certificate_key_alg ASNEW ssl_publickey_algorithm
FIELDALIAS-L                            = L ASNEW ssl_subject_locality
FIELDALIAS-C                            = C ASNEW ssl_subject_country
FIELDALIAS-ST                           = ST ASNEW ssl_subject_state
FIELDALIAS-O                            = O ASNEW ssl_subject_organization
FIELDALIAS-certificate_sig_alg          = certificate_sig_alg ASNEW ssl_signature_algorithm
FIELDALIAS-certificate_subject          = certificate_subject ASNEW ssl_subject
FIELDALIAS-fingerprint                  = fingerprint ASNEW ssl_hash
FIELDALIAS-san_email                    = san_email ASNEW ssl_subject_email
EVAL-product                            = "Zeek"
EVAL-sensor_name                        = coalesce(system_name, host, "unknown")
EVAL-vendor_product                     = "Zeek"
EVAL-ssl_issuer_common_name             = replace(mvindex(split(ssl_issuer,","),0), "CN=","")
EVAL-ssl_subject_common_name            = replace(mvindex(split(certificate_subject,","),0), "CN=","")
EVAL-ssl_subject_email_domain           = mvindex(split(ssl_subject_email, "@"),1)
EVAL-ssl_validity_window                = ssl_end_time - ssl_start_time
EVAL-ssl_is_valid                       = if(tonumber(ssl_end_time) >= now() and tonumber(ssl_start_time) <= now(),"true", "false")

[zeek:smtp]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:ssh]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
FIELDALIAS-client    = client ASNEW user_agent
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"
EVAL-action          = case(auth_success="T" and auth_attempts!="-","success",auth_success="F" and auth_attempts!="-", "failure")

[zeek:pe]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:dhcp]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:ntp]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:irc]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:rdp]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:traceroute]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:tunnel]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:dpd]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:software]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:weird]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:notice]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
FIELDALIAS-msg       = msg AS description
FIELDALIAS-file_desc = file_desc AS file_description
FIELDALIAS-fuid      = fuid AS file_id
FIELDALIAS-type      = note AS type
FIELDALIAS-dst       = dst ASNEW dest_ip
FIELDALIAS-src       = src ASNEW src_ip
FIELDALIAS-p         = p ASNEW src_port
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:capture_loss]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:reporter]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"
EVAL-log_level       = mvindex(split(level,"::"),1)

[zeek:dce_rpc]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
FIELDALIAS-rtt       = rtt ASNEW duration
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:analyzer]
FIELDALIAS-id_orig_h     = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p     = id_orig_p AS src_port
FIELDALIAS-id_resp_h     = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p     = id_resp_p AS dest_port
FIELDALIAS-proto         = proto ASNEW transport
FIELDALIAS-src_mac       = mac AS src_mac
FIELDALIAS-ts            = ts AS timestamp
FIELDALIAS-uid           = uid AS flow_id
FIELDALIAS-analyzer_name = analyzer_name ASNEW protocol
FIELDALIAS-fuid          = fuid AS file_id
EVAL-product             = "Zeek"
EVAL-sensor_name         = coalesce(system_name, host, "unknown")
EVAL-vendor_product      = "Zeek"

[zeek:kerberos]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:ntlm]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
FIELDALIAS-username  = username ASNEW user
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"
EVAL-action          = case(success=="T","success", isnotnull(success), "failure", isnotnull(action), action)

[zeek:smb_cmd]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:snmp]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:quic]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:smb_files]
FIELDALIAS-id_orig_h      = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p      = id_orig_p AS src_port
FIELDALIAS-id_resp_h      = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p      = id_resp_p AS dest_port
FIELDALIAS-proto          = proto ASNEW transport
FIELDALIAS-src_mac        = mac AS src_mac
FIELDALIAS-ts             = ts AS timestamp
FIELDALIAS-uid            = uid AS flow_id
FIELDALIAS-fuid           = fuid ASNEW file_id
FIELDALIAS-name           = name ASNEW file_name
FIELDALIAS-path           = path ASNEW file_path
FIELDALIAS-size           = size ASNEW file_size
FIELDALIAS-times_accessed = times_accessed ASNEW file_access_time
FIELDALIAS-times_modified = times_modified ASNEW file_modify_time
FIELDALIAS-times_created  = times_created ASNEW file_create_time
EVAL-product              = "Zeek"
EVAL-sensor_name          = coalesce(system_name, host, "unknown")
EVAL-vendor_product       = "Zeek"

[zeek:smb_mapping]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
FIELDALIAS-path      = path ASNEW file_path
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:known_certs]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:known_hosts]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[zeek:known_services]
FIELDALIAS-id_orig_h = id_orig_h AS src id_orig_h AS src_ip
FIELDALIAS-id_orig_p = id_orig_p AS src_port
FIELDALIAS-id_resp_h = id_resp_h AS dest id_resp_h AS dest_ip
FIELDALIAS-id_resp_p = id_resp_p AS dest_port
FIELDALIAS-proto     = proto ASNEW transport
FIELDALIAS-src_mac   = mac AS src_mac
FIELDALIAS-ts        = ts AS timestamp
FIELDALIAS-uid       = uid AS flow_id
EVAL-product         = "Zeek"
EVAL-sensor_name     = coalesce(system_name, host, "unknown")
EVAL-vendor_product  = "Zeek"

[bro:json]
TRUNCATE                      = 0
SHOULD_LINEMERGE              = false
TIME_PREFIX                   = \"ts\"\:
TIME_FORMAT                   = %s.%6N
TRANSFORMS-BroAutoTypeForJson = BroAutoTypeJSON

[(?::){0}bro:*:json]
TRUNCATE                = 0
SHOULD_LINEMERGE        = false
TIME_FORMAT             = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE                 = JSON
FIELDALIAS-dest0        = id.resp_h AS dest
FIELDALIAS-dest_ip0     = id.resp_h AS dest_ip
FIELDALIAS-src0         = id.orig_h AS src
FIELDALIAS-src_ip0      = id.orig_h AS src_ip
FIELDALIAS-src_port0    = id.orig_p AS src_port
EVENT_BREAKER_ENABLE    = true

[source::...bro.*.log]
INDEXED_EXTRACTIONS     = TSV
TRUNCATE                = 0
SHOULD_LINEMERGE        = false
TIME_FORMAT             = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
TRANSFORMS-BroAutoType  = BroAutoType, TrashComments
EVENT_BREAKER_ENABLE    = true
FIELD_HEADER_REGEX      = ^#fields\t(.*)
FIELD_DELIMITER         = \t
FIELD_QUOTE             = \t

[bro]
INDEXED_EXTRACTIONS     = TSV
TRUNCATE                = 0
SHOULD_LINEMERGE        = false
TIME_FORMAT             = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
TRANSFORMS-BroAutoType  = BroAutoType, TrashComments
EVENT_BREAKER_ENABLE    = true
FIELD_HEADER_REGEX      = ^#fields\t(.*)
FIELD_DELIMITER         = \t
FIELD_QUOTE             = \t

[(?::){0}bro(_|:)*]
TRUNCATE                      = 0
SHOULD_LINEMERGE              = false
TIME_FORMAT                   = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD       = 20
REPORT-get_bytes_for_bro_conn = bytes_in_int, bytes_out_int
LOOKUP-LookupTCFlag           = LookupTCFlag TC OUTPUT flag
LOOKUP-VendorInfo             = bro_vendor_info_lookup sourcetype OUTPUT vendor,product,product as vendor_product
LOOKUP-NoticeType             = bro_note_alert_type note OUTPUT type
FIELDALIAS-dest_ip            = id_resp_h AS dest_ip
FIELDALIAS-mailfrom           = mailfrom AS src_user
FIELDALIAS-proxied            = proxied AS product
FIELDALIAS-src                = id_orig_h AS src
FIELDALIAS-src_ip             = id_orig_h AS src_ip
FIELDALIAS-src_port           = id_orig_p AS src_port
FIELDALIAS-uid                = uid AS flow_id
FIELDALIAS-src_mac            = mac AS src_mac
EVAL-sensor_name              = coalesce(system_name, host, "unknown")
EVAL-is_broadcast             = if(src in("0.0.0.0", "255.255.255.255") OR dest in("255.255.255.255", "0.0.0.0"),"true","false")
EVAL-direction                = case(local_orig="true" AND local_resp="true", "internal", local_orig="true" and local_resp="false", "outbound", local_orig="false" and local_resp="false", "external", local_orig="false" and local_resp="true", "inbound", 1=1, "unknown")
EVAL-is_src_internal_ip       = if(cidrmatch("10.0.0.0/8",src) OR cidrmatch("172.16.0.0/12",src) OR cidrmatch("192.168.0.0/16", src), "true", "false")
EVAL-is_dest_internal_ip      = if(cidrmatch("10.0.0.0/8",dest) OR cidrmatch("172.16.0.0/12",dest) OR cidrmatch("192.168.0.0/16", dest), "true", "false")
EVAL-id_resp_h                = dest
EVAL-id_resp_p                = dest_port
EVAL-id_orig_h                = src
EVAL-id_orig_p                = src_port
EVAL-bytes                    = if(isnum(bytes),bytes,bytes_in+bytes_out)
EVAL-packets                  = if(isnum(packets),packets,packets_in+packets_out)
EVAL-duration                 = if(isnum(duration),duration,null())
EVAL-dest_port                = coalesce('id.resp_p',id_resp_p)
EVAL-dvc                      = coalesce(extracted_host, host, hostname)
EVAL-dest_host                = coalesce(extracted_host, host, hostname)
EVAL-vendor_action            = split(actions, ",")
EVENT_BREAKER_ENABLE          = true

[bro_http]
EXTRACT-uri_query            = \?(?<uri_query>.*) in uri
EXTRACT-host_header          = \"host\":\"(?<host_header>[^\"]*)
FIELDALIAS-resp_fuids        = resp_fuids{} AS resp_fuids
FIELDALIAS-mime_types        = resp_mime_types{} AS resp_mime_types
FIELDALIAS-tags              = tags{} AS tags
FIELDALIAS-orig_fuids        = orig_fuids{} AS orig_fuids
FIELDALIAS-orig_mime_types   = orig_mime_types{} AS orig_mime_types
FIELDALIAS-uri_path          = uri AS uri_path
FIELDALIAS-request_body_len  = request_body_len AS bytes_out
FIELDALIAS-response_body_len = response_body_len AS bytes_in
FIELDALIAS-resp_mime_types   = resp_mime_types{} AS http_content_type
FIELDALIAS-method            = method AS http_method
FIELDALIAS-referrer          = referrer AS http_referrer
FIELDALIAS-status_code       = status_code AS status
FIELDALIAS-user_agent        = user_agent AS http_user_agent
FIELDALIAS-username          = username as user
FIELDALIAS-site              = host_header AS site
FIELDALIAS-http_user_agent   = user_agent AS http_user_agent
FIELDALIAS-http_referrer     = referrer AS http_referrer
FIELDALIAS-http_method       = method AS http_method
EVAL-url                     = if(isnotnull(coalesce('id.resp_p',id_resp_p)),coalesce(extracted_host,spath(_raw,"host"), hostname).":".coalesce('id.resp_p',id_resp_p).uri, coalesce(extracted_host,spath(_raw,"host"), hostname).uri)
EVAL-http_user_agent_length  = len(http_user_agent)

[bro_smtp]
LOOKUP-protocol_for_bro_smtp = bro_protocol_lookup sourcetype OUTPUT protocol
FIELDALIAS-orig_src          = id_orig_h AS orig_src
FIELDALIAS-recipient         = rcptto{} AS recipient
FIELDALIAS-return_addr       = reply_to AS return_addr
FIELDALIAS-orig_recipient    = rcptto{} AS orig_recipient
FIELDALIAS-mailfrom          = mailfrom as src_user
FIELDALIAS-to                = to{} AS to
FIELDALIAS-path              = path{} AS path
FIELDALIAS-fuids             = fuids{} AS fuids
FIELDALIAS-rcptto            = rcptto{} AS rcptto
FIELDALIAS-msg_id            = msg_id AS message_id

[bro_notice]
FIELDALIAS-dest     = dst AS dest
FIELDALIAS-dvc      = host AS dvc
FIELDALIAS-category = note AS category
FIELDALIAS-id       = uid AS id
EVAL-ids_type       = "network"

[bro_conn]
LOOKUP-LookupAction       = bro_action_lookup status OUTPUT action
LOOKUP-LookupConnState    = LookupConnState conn_state OUTPUT conn_state_meaning, action
FIELDALIAS-orig_bytes     = orig_bytes AS bytes_out
FIELDALIAS-orig_pkts      = orig_pkts AS packets_out
FIELDALIAS-proto          = proto AS transport
FIELDALIAS-resp_bytes     = resp_bytes AS bytes_in
FIELDALIAS-resp_pkts      = resp_pkts AS packets_in
FIELDALIAS-tunnel_parents = tunnel_parents{} AS tunnel_parents
FIELDALIAS-tcp_flag       = conn_state AS tcp_flag
FIELDALIAS-dest_mac       = resp_l2_addr AS dest_mac
FIELDALIAS-service        = service AS app
EVAL-bytes                = if(isnum(bytes),bytes,bytes_in+bytes_out)
EVAL-packets              = packets_in + packets_out
EVAL-duration             = if(isnum(duration),duration,null())

[bro_dns]
FIELDALIAS-reply_code_id = rcode AS reply_code_id
FIELDALIAS-reply_code    = rcode_name ASNEW reply_code
FIELDALIAS-answers       = answers{} AS answers
FIELDALIAS-TTLs          = TTLs{} AS TTLs
FIELDALIAS-query_type    = qtype_name AS query_type
FIELDALIAS-proto         = proto AS transport
FIELDALIAS-rcode_name    = rcode_name AS status
FIELDALIAS-qtype_name    = qtype_name  AS record_type
FIELDALIAS-record_type   = qtype_name AS record_type
EVAL-message_type        = if(isnotnull(rcode),"RESPONSE","QUERY")
EVAL-answer              = mvindex(answers, 0)

[bro_dhcp]
LOOKUP-LookupTransport    = bro_protocol_lookup sourcetype OUTPUT transport as signature
FIELDALIAS-lease_duration = lease_time AS lease_duration

[bro_files]
EXTRACT-source                  = \"source\":\"(?<transport>\w+)\"
FIELDALIAS-analyzers            = analyzers{} AS analyzers
FIELDALIAS-rx_hosts             = rx_hosts{} AS rx_hosts
FIELDALIAS-tx_hosts             = tx_hosts{} AS tx_hosts
FIELDALIAS-mime_type_attachment = mime_type AS attachment_type
FIELDALIAS-filename             = filename AS file_name
FIELDALIAS-total_bytes          = total_bytes AS file_size
FIELDALIAS-src_host             = tx_hosts{} AS src_host
FIELDALIAS-dest_host            = rx_hosts{} AS dest_host
FIELDALIAS-bytes                = seen_bytes AS bytes
FIELDALIAS-object               = filename AS object

[bro_services]
FIELDALIAS-service = service{} AS service

[bro_software]
FIELDALIAS-host     = host_header AS src_host
FIELDALIAS-version  = version.major AS version_major
FIELDALIAS-version1 = version.minor AS version_minor
FIELDALIAS-version2 = version.minor2 AS version_minor2
EVAL-version        = if(isnotnull(version_major),version_major,"").if(isnotnull(version_minor),".".version_minor,"").if(isnotnull(version_minor2),".".version_minor2,"")
EVAL-tx_host        = src_host

[bro_ssl]
FIELDALIAS-cert_chain              = cert_chain_fuids{} AS cert_chain_fuids
FIELDALIAS-client_cert_chain       = client_cert_chain_fuids{} AS client_cert_chain_fuids
FIELDALIAS-ssl_issuer              = issuer AS ssl_issuer
FIELDALIAS-ssl_subject             = subject AS ssl_subject
FIELDALIAS-ssl_subject_common_name = server_name AS ssl_subject_common_name
FIELDALIAS-ssl_cipher              = cipher AS ssl_cipher

[bro_x509]
EXTRACT-ssl_extracts               = emailAddress=(?<ssl_issuer_email>\w+\@\w+\.\w+),
EXTRACT-ssl_org                    = ,O=(?<ssl_issuer_organization>[A-Za-z0-9 \.\'\,\-\x5C]+),
FIELDALIAS-ssl_end_time            = certificate.not_valid_after AS ssl_end_time
FIELDALIAS-ssl_issuer              = certificate.issuer AS ssl_issuer
FIELDALIAS-ssl_publickey_algorithm = certificate.key_alg AS ssl_publickey_algorithm
FIELDALIAS-ssl_serial              = certificate.serial AS ssl_serial
FIELDALIAS-ssl_signature_algorithm = certificate.sig_alg AS ssl_signature_algorithm
FIELDALIAS-ssl_start_time          = certificate.not_valid_before AS ssl_start_time
FIELDALIAS-ssl_subject             = certificate.subject AS ssl_subject
FIELDALIAS-ssl_version             = certificate.version AS ssl_version
EVAL-ssl_validity_window           = round(strptime(ssl_end_time,"%Y-%m-%dT%H:%M:%S.%6NZ") - strptime(ssl_start_time,"%Y-%m-%dT%H:%M:%S.%6NZ"),0)

[bro:dhcp:json]
LOOKUP-LookupTransport    = bro_protocol_lookup sourcetype OUTPUT transport as signature
FIELDALIAS-lease_duration = lease_time AS lease_duration

[bro:conn:json]
LOOKUP-LookupAction       = bro_action_lookup status OUTPUT action
LOOKUP-LookupConnState    = LookupConnState conn_state OUTPUT conn_state_meaning, action
FIELDALIAS-orig_bytes     = orig_bytes AS bytes_out
FIELDALIAS-orig_pkts      = orig_pkts AS packets_out
FIELDALIAS-proto          = proto AS transport
FIELDALIAS-resp_bytes     = resp_bytes AS bytes_in
FIELDALIAS-resp_pkts      = resp_pkts AS packets_in
FIELDALIAS-tunnel_parents = tunnel_parents{} AS tunnel_parents
FIELDALIAS-tcp_flag       = conn_state AS tcp_flag
FIELDALIAS-dest_mac       = resp_l2_addr AS dest_mac
FIELDALIAS-service        = service AS app
EVAL-bytes                = if(isnum(bytes),bytes,bytes_in+bytes_out)
EVAL-packets              = packets_in + packets_out
EVAL-duration             = if(isnum(duration),duration,null())

[bro:dns:json]
FIELDALIAS-reply_code_id = rcode AS reply_code_id
FIELDALIAS-reply_code    = rcode_name ASNEW reply_code
FIELDALIAS-answers       = answers{} AS answers
FIELDALIAS-TTLs          = TTLs{} AS TTLs
FIELDALIAS-query_type    = qtype_name AS query_type
FIELDALIAS-proto         = proto AS transport
FIELDALIAS-rcode_name    = rcode_name AS status
FIELDALIAS-qtype_name    = qtype_name  AS record_type
EVAL-message_type        = if(isnotnull(rcode),"RESPONSE","QUERY")
EVAL-answer              = mvindex(answers, 0)

[bro:files:json]
EXTRACT-source                  = \"source\":\"(?<transport>\w+)\"
FIELDALIAS-analyzers            = analyzers{} AS analyzers
FIELDALIAS-rx_hosts             = rx_hosts{} AS rx_hosts
FIELDALIAS-tx_hosts             = tx_hosts{} AS tx_hosts
FIELDALIAS-mime_type_attachment = mime_type AS attachment_type
FIELDALIAS-filename             = filename AS file_name
FIELDALIAS-total_bytes          = total_bytes AS file_size
FIELDALIAS-src_host             = tx_hosts{} AS src_host
FIELDALIAS-dest_host            = rx_hosts{} AS dest_host
FIELDALIAS-bytes                = seen_bytes AS bytes
FIELDALIAS-object               = filename AS object

[bro:http:json]
EXTRACT-uri_query            = \?(?<uri_query>.*) in uri
EXTRACT-host_header          = \"host\":\"(?<host_header>[^\"]*)
FIELDALIAS-resp_fuids        = resp_fuids{} AS resp_fuids
FIELDALIAS-mime_types        = resp_mime_types{} AS resp_mime_types
FIELDALIAS-tags              = tags{} AS tags
FIELDALIAS-orig_fuids        = orig_fuids{} AS orig_fuids
FIELDALIAS-orig_mime_types   = orig_mime_types{} AS orig_mime_types
FIELDALIAS-uri_path          = uri AS uri_path
FIELDALIAS-request_body_len  = request_body_len AS bytes_out
FIELDALIAS-response_body_len = response_body_len AS bytes_in
FIELDALIAS-resp_mime_types   = resp_mime_types{} AS http_content_type
FIELDALIAS-method            = method AS http_method
FIELDALIAS-referrer          = referrer AS http_referrer
FIELDALIAS-status_code       = status_code AS status
FIELDALIAS-user_agent        = user_agent AS http_user_agent
FIELDALIAS-username          = username as user
FIELDALIAS-site              = host_header AS site
FIELDALIAS-http_user_agent   = user_agent AS http_user_agent
FIELDALIAS-http_referrer     = referrer AS http_referrer
FIELDALIAS-http_method       = method AS http_method
EVAL-url                     = if(isnotnull(coalesce('id.resp_p',id_resp_p)),coalesce(extracted_host,spath(_raw,"host"), hostname).":".coalesce('id.resp_p',id_resp_p).uri, coalesce(extracted_host,spath(_raw,"host"), hostname).uri)
EVAL-http_user_agent_length  = len(http_user_agent)

[bro:notice:json]
FIELDALIAS-dest     = dst AS dest
FIELDALIAS-dvc      = host AS dvc
FIELDALIAS-category = note AS category
FIELDALIAS-id       = uid AS id
EVAL-ids_type       = "network"

[bro:services:json]
FIELDALIAS-service = service{} AS service

[bro:ssl:json]
FIELDALIAS-cert_chain              = cert_chain_fuids{} AS cert_chain_fuids
FIELDALIAS-client_cert_chain       = client_cert_chain_fuids{} AS client_cert_chain_fuids
FIELDALIAS-ssl_issuer              = issuer AS ssl_issuer
FIELDALIAS-ssl_subject             = subject AS ssl_subject
FIELDALIAS-ssl_subject_common_name = server_name AS ssl_subject_common_name
FIELDALIAS-ssl_cipher              = cipher AS ssl_cipher

[bro:smtp:json]
LOOKUP-protocol_for_bro_smtp = bro_protocol_lookup sourcetype OUTPUT protocol
FIELDALIAS-mailfrom          = mailfrom as src_user
FIELDALIAS-to                = to{} AS to
FIELDALIAS-path              = path{} AS path
FIELDALIAS-fuids             = fuids{} AS fuids
FIELDALIAS-rcptto            = rcptto{} AS rcptto
FIELDALIAS-orig_src          = id.orig_h AS orig_src
FIELDALIAS-recipient         = rcptto{} AS recipient
FIELDALIAS-return_addr       = reply_to AS return_addr
FIELDALIAS-orig_recipient    = rcptto{} AS orig_recipient
FIELDALIAS-msg_id            = msg_id AS message_id

[bro:software:json]
FIELDALIAS-host     = host_header AS src_host
FIELDALIAS-version  = version.major AS version_major
FIELDALIAS-version1 = version.minor AS version_minor
FIELDALIAS-version2 = version.minor2 AS version_minor2
EVAL-version        = if(isnotnull(version_major),version_major,"").if(isnotnull(version_minor),".".version_minor,"").if(isnotnull(version_minor2),".".version_minor2,"")
EVAL-tx_host        = src_host

[bro:x509:json]
EXTRACT-ssl_extracts               = emailAddress=(?<ssl_issuer_email>\w+\@\w+\.\w+),
EXTRACT-ssl_org                    = ,O=(?<ssl_issuer_organization>[A-Za-z0-9 \.\"\,\-\x5C]+),
FIELDALIAS-ssl_end_time            = certificate.not_valid_after AS ssl_end_time
FIELDALIAS-ssl_issuer              = certificate.issuer AS ssl_issuer
FIELDALIAS-ssl_publickey_algorithm = certificate.key_alg AS ssl_publickey_algorithm
FIELDALIAS-ssl_serial              = certificate.serial AS ssl_serial
FIELDALIAS-ssl_signature_algorithm = certificate.sig_alg AS ssl_signature_algorithm
FIELDALIAS-ssl_start_time          = certificate.not_valid_before AS ssl_start_time
FIELDALIAS-ssl_subject             = certificate.subject AS ssl_subject
FIELDALIAS-ssl_version             = certificate.version AS ssl_version
EVAL-ssl_validity_window           = round(strptime(ssl_end_time,"%Y-%m-%dT%H:%M:%S.%6NZ") - strptime(ssl_start_time,"%Y-%m-%dT%H:%M:%S.%6NZ"),0)

[bro_filter]
rename = bro_packet_filter

[bro_policy]
rename = bro_notice_policy

[bro_entities]
rename = bro_smtp_entities

[bro_conn_long]
FIELDALIAS-proto = proto AS transport

[bro:conn_long:json]
FIELDALIAS-proto = proto AS transport 