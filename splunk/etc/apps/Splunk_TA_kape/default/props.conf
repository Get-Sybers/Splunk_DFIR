[kape:json]
KV_MODE = json

EVAL-host = upper(host)
EVAL-Computer = upper(Computer)

# Field extraction transformations
TRANSFORMS-kape_host = kapeHostExtraction
TRANSFORMS-extract_json_payload = json_payload_extraction
TRANSFORMS-kape_file_extension = ExtractFileExtension
TRANSFORMS-kape_file_ext_from_sourcetype = ExtractKapeFileExtFromSourcetype

EVAL-sourcetype = lower(sourcetype)
EVAL-host = upper(host)
EVAL-Computer = upper(Computer)

# Parsing and performance settings
NO_BINARY_CHECK = true
TIMESTAMP_FIELDS = Timecreated
TRUNCATE = 0
MAX_EVENTS = 1000000
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)\{



################ Kape CSV's ################
[kape:csv]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
# Call the transform that extracts the folder name from the source path.
TRANSFORMS-sourcetype = extract_kapecsv_sourcetype


# ################ Kape Sourcetypes ################
# [kape:csv:*]
# NO_BINARY_CHECK = true
# INDEXED_EXTRACTIONS = csv
# KV_MODE = none
# EVAL-timestamp = coalesce(CreatedOn, LastStart, NameKeyLastWrite, LastWriteTimestamp)
# TIMESTAMP_FIELDS = timestamp
# TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
# TRUNCATE = 0
# MAX_EVENTS = 0
# SHOULD_LINEMERGE = false

################ kape:csv:Registry ################
[kape:csv:Registry]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
EVAL-timestamp = coalesce(LastWriteTimestamp, CreatedOn)
# EVAL-timestamp = LastWriteTimestamp
TIMESTAMP_FIELDS = timestamp
TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
TRUNCATE = 0
MAX_EVENTS = 0
SHOULD_LINEMERGE = false

# # # # # # # # # kape:csv:FileFolderAccess # # # # # # # # #
[kape:csv:FileFolderAccess]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
# EVAL-timestamp = coalesce(LastWriteTime, LastInteracted, AccessedOn, ModifiedOn, FirstInteracted)
EVAL-timestamp = LastWriteTime
TIMESTAMP_FIELDS = timestamp
TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
TRUNCATE = 0
MAX_EVENTS = 0
SHOULD_LINEMERGE = false

################ kape:csv:FileDeletion ################
[kape:csv:FileDeletion]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
EVAL-timestamp = DeletedOn
TIMESTAMP_FIELDS = timestamp
TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
TRUNCATE = 0
MAX_EVENTS = 0
SHOULD_LINEMERGE = false

#-------------------- Not validated. needs data --------------------
# # # # # # # # # kape:csv:EventLogs # # # # # # # # #
[kape:csv:EventLogs]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
EVAL-timestamp = coalesce(LastWriteTime, LastInteracted, AccessedOn, ModifiedOn, FirstInteracted)
TIMESTAMP_FIELDS = timestamp
TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
TRUNCATE = 0
MAX_EVENTS = 0
SHOULD_LINEMERGE = false

################ kape:csv:ProgramExecution ################
[kape:csv:ProgramExecution]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
EVAL-timestamp = coalesce(LastWriteTime, LastInteracted, AccessedOn, ModifiedOn, FirstInteracted)
TIMESTAMP_FIELDS = timestamp
TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
TRUNCATE = 0
MAX_EVENTS = 0
SHOULD_LINEMERGE = false

################ kape:csv:SOF-ELK ################
[kape:csv:SOF-ELK]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
EVAL-timestamp = coalesce(LastWriteTime, LastInteracted, AccessedOn, ModifiedOn, FirstInteracted)
TIMESTAMP_FIELDS = timestamp
TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
TRUNCATE = 0
MAX_EVENTS = 0
SHOULD_LINEMERGE = false

################ kape:csv:SQLDatabases ################
[kape:csv:SQLDatabases]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
EVAL-timestamp = coalesce(LastWriteTime, LastInteracted, AccessedOn, ModifiedOn, FirstInteracted)
TIMESTAMP_FIELDS = timestamp
TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
TRUNCATE = 0
MAX_EVENTS = 0
SHOULD_LINEMERGE = false

# # # # # # # # # kape:csv:SRUMDatabase # # # # # # # # #
[kape:csv:SRUMDatabase]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
# EVAL-timestamp = coalesce(LastWriteTime, LastInteracted, AccessedOn, ModifiedOn, FirstInteracted)
EVAL-timestamp = Timestamp
TIMESTAMP_FIELDS = timestamp
TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
TRUNCATE = 0
MAX_EVENTS = 0
SHOULD_LINEMERGE = false

# # # # # # # # # kape:csv:SUMDatabase # # # # # # # # #
[kape:csv:SUMDatabase]
NO_BINARY_CHECK = true
INDEXED_EXTRACTIONS = csv
KV_MODE = none
EVAL-timestamp = coalesce(LastWriteTime, LastInteracted, AccessedOn, ModifiedOn, FirstInteracted)
TIMESTAMP_FIELDS = timestamp
TIMESTAMP_FORMAT = %Y-%m-%d %H:%M:%S.%7N
TRUNCATE = 0
MAX_EVENTS = 0
SHOULD_LINEMERGE = false